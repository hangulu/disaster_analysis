---
title: 'Unnatural Disasters: The Data Behind Anthropogenic Climate Change'
author: "Hakeem Angulu and Louie Ayre"
date: "12/8/2018"
output: 
  pdf_document:
    fig_height: 3.5
    fig_width: 5
    highlight: pygments
    keep_tex: yes
    latex_engine: xelatex
fontsize: 10pt
mainfont: Gotham
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Regional Analysis

The storm analysis is regional, based on the most prevalent storms in each of the following regions:
\begin{itemize}
  \item \textit{Northeast}: Connecticut, Maine, Massachussets, New Hampshire, Rhode Island, Vermont, New Jersey, New York, Pennsylvania, Delaware, Maryland, DC
  
  This region is primiarily affected by snowstorms, which include: avalanches, blizzards, hail, and more
  \item \textit{California}
  
  This region is primarily affected by heatstorms, which include: wildfires, droughts, and more
  \item \textit{South}: Florida, Georgia, North Carolina, South Carolina, Virginia, West Virginia, Alabama, Kentucky, Mississippi, Tennessee, Arkansas, Louisiana, Oklahoma, and Texas
  
  This region is primarily affected by rainstorms, which include flash floods, floods, heavy rain, hurricanes, and more
  \item \textit{Midwest}: Illinois, Indiana, Iowa, Kansas, Michigan, Minnesota, Missouri, Nebraska, North Dakota, Ohio, South Dakota and Wisconsin
  
  This region is primarily affected by windstorms, which include tornadoes, high winds, and more
\end{itemize}

```{r libs}
library(quantmod)
```


```{r northeast}
# Set the working directory
setwd("/Users/hakeemangulu/Code/disaster_analysis/data/cleaned")

# Read in the CSV
northeast <- read.csv("northeast_storms.csv")

# Adjust property damage numbers for inflation: https://stackoverflow.com/questions/12590180/inflation-adjusted-prices-package
adj_inflation <- function(data){
  getSymbols("CPIAUCSL", src='FRED')
  avg.cpi <- apply.yearly(CPIAUCSL, mean)
  cf <- avg.cpi/as.numeric(avg.cpi['2016']) # using 2018 as the base year
  df <- as.data.frame(cf)
  df$year <- 1947:2018
  data <- merge(data, df, all=FALSE)
  data$adj_damage <- data$damage / data$CPIAUCSL
  data$X <- NULL
  return(data)
}

northeast <- adj_inflation(northeast)

```

```{r}
model_1 = lm(damage ~ coal_emis + petrol_emis + nonrenew_energy_prod + co2_conc, data = northeast)
summary(model_1)
```

